import TextUrlField from "./TextUrlField";

interface VulnerabilityIdFieldProps {
    vulnerability_id: string;
}

const VULNERABILITY_URLS = {
    ASB: "https://osv.dev/vulnerability/",
    BIT: "https://osv.dev/vulnerability/",
    CGA: "https://images.chainguard.dev/security/",
    CVE: "https://nvd.nist.gov/vuln/detail/",
    DLA: "https://security-tracker.debian.org/tracker/",
    DSA: "https://security-tracker.debian.org/tracker/",
    GHSA: "https://github.com/advisories/",
    GO: "https://pkg.go.dev/vuln/",
    OSV: "https://osv.dev/vulnerability/",
    PYSEC: "https://osv.dev/vulnerability/",
    SNYK: "https://snyk.io/vuln/",
    RUSTSEC: "https://rustsec.org/advisories/",
};

export function get_vulnerability_url(vulnerability_id: string): string {
    let return_value = "";

    Object.entries(VULNERABILITY_URLS).forEach((entry) => {
        const [key, value] = entry;
        if (vulnerability_id.startsWith(key)) {
            return_value = value + vulnerability_id;
        }
    });

    return return_value;
}

const VulnerabilityIdField = ({ vulnerability_id }: VulnerabilityIdFieldProps) => {
    const url = get_vulnerability_url(vulnerability_id);
    return <TextUrlField text={vulnerability_id} url={url} label="Vulnerability Id" new_tab={true} />;
};

export default VulnerabilityIdField;
